"use strict";(self.webpackChunk_map_colonies_developer_portal=self.webpackChunk_map_colonies_developer_portal||[]).push([[6232],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},l="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,m=c(e,["components","mdxType","originalType","parentName"]),l=p(n),u=o,g=l["".concat(s,".").concat(u)]||l[u]||d[u]||a;return n?r.createElement(g,i(i({ref:t},m),{},{components:n})):r.createElement(g,i({ref:t},m))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[l]="string"==typeof e?e:o,i[1]=c;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},40796:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const a={id:"3d-getting-started",slug:"3d-getting-started",title:"Getting Started",tags:["guide","3D","terrain","getting-started"]},i=void 0,c={unversionedId:"MapColonies/3D/Guides/3d-getting-started",id:"MapColonies/3D/Guides/3d-getting-started",title:"Getting Started",description:"Step by step guide",source:"@site/docs/MapColonies/3D/Guides/3D_getting_started.md",sourceDirName:"MapColonies/3D/Guides",slug:"/MapColonies/3D/Guides/3d-getting-started",permalink:"/developer-portal/pr-preview/pr-80/docs/MapColonies/3D/Guides/3d-getting-started",draft:!1,editUrl:"https://github.com/MapColonies/developer-portal/tree/main/packages/create-docusaurus/templates/shared/docs/MapColonies/3D/Guides/3D_getting_started.md",tags:[{label:"guide",permalink:"/developer-portal/pr-preview/pr-80/docs/tags/guide"},{label:"3D",permalink:"/developer-portal/pr-preview/pr-80/docs/tags/3-d"},{label:"terrain",permalink:"/developer-portal/pr-preview/pr-80/docs/tags/terrain"},{label:"getting-started",permalink:"/developer-portal/pr-preview/pr-80/docs/tags/getting-started"}],version:"current",frontMatter:{id:"3d-getting-started",slug:"3d-getting-started",title:"Getting Started",tags:["guide","3D","terrain","getting-started"]},sidebar:"gettingStartedSidebar",previous:{title:"Export Guide",permalink:"/developer-portal/pr-preview/pr-80/docs/MapColonies/Raster/Guides/raster-export-guide"},next:{title:"Terrain Height Extraction",permalink:"/developer-portal/pr-preview/pr-80/docs/MapColonies/3D/Guides/mesh-height-extraction"}},s={},p=[{value:"Step by step guide",id:"step-by-step-guide",level:2},{value:"Flow diagram",id:"flow-diagram",level:2},{value:"Query CSW catalog (Step 1)",id:"query-csw-catalog-step-1",level:2},{value:"Get layer URI (Step 2)",id:"get-layer-uri-step-2",level:2},{value:"Get terrain provider URI (Step 2.1, optional)",id:"get-terrain-provider-uri-step-21-optional",level:2},{value:"Step 3",id:"step-3",level:2},{value:"Construct Client side Layer",id:"construct-client-side-layer",level:3},{value:"Cesium",id:"cesium",level:3}],m={toc:p},l="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(l,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"step-by-step-guide"},"Step by step guide"),(0,o.kt)("p",null,"The following guide will help you understand, ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Step-by-step"))," the best practices of how to work with the Map Colonies ",(0,o.kt)("strong",{parentName:"p"},"3D")," Catalog and how to consume mapping products in a ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"dynamic way"))," (materials might be changed or added)"),(0,o.kt)("h2",{id:"flow-diagram"},"Flow diagram"),(0,o.kt)("mermaid",{value:"flowchart LR\n    subgraph  Prerequisite\n      direction LR\n      a1[Define filter]\n      a2[Get Auth Token]\n    end\n\n    a1 -- filter --\x3e B[STEP 1<br/> Query CSW catalog]\n    a2 -- token --\x3e B\n    subgraph  Links extract\n      direction LR\n      c1[STEP 2<br/>Get layer's URI]\n      c2[STEP 2.1 optional<br/>Get terrain provider URI]\n    end\n    B -- xml --\x3e c1\n    B -- xml --\x3e c2\n    c1 -- layer_URI --\x3e D[STEP 3<br/>Cesium]\n    c2 -- terrain_URI --\x3e D[STEP 3<br/>Cesium]"}),(0,o.kt)("h2",{id:"query-csw-catalog-step-1"},"Query CSW catalog (Step 1)"),(0,o.kt)("p",null,"Query ",(0,o.kt)("strong",{parentName:"p"},"3D CSW catalog")," service to find item(s) according to desired filter ",(0,o.kt)("a",{parentName:"p",href:"/docs/ogc/protocols/ogc-csw/ogc-csw-examples"},"example are here")),(0,o.kt)("p",null,"Filter should be based on ",(0,o.kt)("a",{parentName:"p",href:"/docs/MapColonies/3D/services/catalog/catalog-profile-v2"},"3D profile")),(0,o.kt)("p",null,"Example query based on ",(0,o.kt)("inlineCode",{parentName:"p"},"mc:classification")," profile field"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="GetRecords Request"',title:'"GetRecords','Request"':!0},'POST Request\n\nurl:\n\'<D3-CATALOG-SERVICE_URL>/csw\'\n\nbody (XML):\n<?xml version="1.0" encoding="UTF-8"?>\n<csw:GetRecords outputFormat="application/xml"  outputSchema="http://schema.mapcolonies.com/3d" resultType="results" service="CSW" version="2.0.2" startPosition="1" maxRecords="200" xmlns:mc="http://schema.mapcolonies.com/3d" xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" xmlns:ogc="http://www.opengis.net/ogc">\n    <csw:Query typeNames="csw:Record">\n        <csw:ElementSetName>full</csw:ElementSetName>\n        <csw:Constraint version="1.1.0">\n            <ogc:Filter>\n                <ogc:Or>\n                    <ogc:PropertyIsEqualTo>\n                        <ogc:PropertyName>mc:classification</ogc:PropertyName>\n                        <ogc:Literal>5</ogc:Literal>\n                    </ogc:PropertyIsEqualTo>\n                    <ogc:PropertyIsEqualTo>\n                        <ogc:PropertyName>mc:productType</ogc:PropertyName>\n                        <ogc:Literal>QuantizedMeshDTMBest</ogc:Literal>\n                    </ogc:PropertyIsEqualTo>\n                </ogc:Or>\n            </ogc:Filter>\n        </csw:Constraint>\n    </csw:Query>\n</csw:GetRecords>\n')),(0,o.kt)("p",null,"You will get GetRecords XML Response with product ",(0,o.kt)("strong",{parentName:"p"},"metadata"),"."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Response example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="Search Results Example"',title:'"Search',Results:!0,'Example"':!0},'    <?xml version="1.0" encoding="UTF-8"?>\n    <csw:GetRecordsResponse xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dct="http://purl.org/dc/terms/" xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:gml="http://www.opengis.net/gml" xmlns:mc="http://schema.mapcolonies.com/3d" xmlns:ows="http://www.opengis.net/ows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.0.2" xsi:schemaLocation="http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd">\n    <csw:SearchStatus timestamp="2022-03-27T06:45:54Z" />\n    <csw:SearchResults numberOfRecordsMatched="2" numberOfRecordsReturned="2" nextRecord="0" recordSchema="http://schema.mapcolonies.com/3d" elementSet="full">\n        <mc:MC3DRecord>\n            <mc:accuracyLEP90>999.0</mc:accuracyLEP90>\n            <mc:classification>5</mc:classification>\n            <mc:footprint>{"type":"Polygon","coordinates":[[[31.2603,33.4345],[31.2603,34.4888],[32.3353,34.4888],[32.3353,33.4345],[31.2603,33.4345]]]}</mc:footprint>\n            <mc:geographicArea>\u05d9\u05e9\u05e8\u05d0\u05dc</mc:geographicArea>\n            <mc:maxHorizontalAccuracyCE90>999.0</mc:maxHorizontalAccuracyCE90>\n            <mc:id>c2bbeeee-6081-4e69-918c-287f48ea244d</mc:id>\n            <mc:links scheme="3D_LAYER" name="" description="">http://model-server-3d/15211-65da-4523-9d6f-08016ad51b0d/tileset.json</mc:links>\n            <mc:producerName>DAVID</mc:producerName>\n            <mc:productBBox>31.2603,33.4345,32.3353,34.4888</mc:productBBox>\n            <mc:productId>c2bbeeee-6081-4e69-918c-287f48ea244d</mc:productId>\n            <mc:productName>\u05de\u05d5\u05d3\u05dc \u05e4\u05e8\u05d9\u05d6</mc:productName>\n            <mc:productType>3DPhotoRealistic</mc:productType>\n            <mc:productVersion>1</mc:productVersion>\n            <mc:productionMethod>photogrammetric</mc:productionMethod>\n            <mc:productionSystem>P-30</mc:productionSystem>\n            <mc:productionSystemVersion>1</mc:productionSystemVersion>\n            <mc:region>\u05e6\u05e4\u05d5\u05df</mc:region>\n            <mc:sensors>sensor1</mc:sensors>\n            <mc:imagingTimeEndUTC>2022-06-15T10:39:00Z</mc:imagingTimeEndUTC>\n            <mc:imagingTimeBeginUTC>2022-06-15T10:39:00Z</mc:imagingTimeBeginUTC>\n            <mc:SRS>4567</mc:SRS>\n            <mc:SRSName>WGS24GEO</mc:SRSName>\n            <mc:type>RECORD_3D</mc:type>\n            <ows:BoundingBox crs="urn:x-ogc:def:crs:EPSG:6.11:4326" dimensions="2">\n                <ows:LowerCorner>33.4345 31.2603</ows:LowerCorner>\n                <ows:UpperCorner>34.4888 32.3353</ows:UpperCorner>\n            </ows:BoundingBox>\n        </mc:MC3DRecord>\n        <mc:MC3DRecord>\n            <mc:accuracyLEP90>999.0</mc:accuracyLEP90>\n            <mc:classification>6</mc:classification>\n            <mc:creationDateUTC>2022-06-15</mc:creationDateUTC>\n            <mc:description>srtm100</mc:description>\n            <mc:footprint>{"type":"Polygon","coordinates":[[[35.2670012825,32.5856881598],[35.2670012825,32.6300363309],[35.3105702702,32.6300363309],[35.3105702702,32.5856881598],[35.2670012825,32.5856881598]]]}</mc:footprint>\n            <mc:geographicArea>North</mc:geographicArea>\n            <mc:maxHorizontalAccuracyCE90>999.0</mc:maxHorizontalAccuracyCE90>\n            <mc:id>11111111-1111-1111-1111-111111111111</mc:id>\n            <mc:links scheme="TERRAIN_QMESH" name="" description="">http://terrain-server.com/terrains/srtm100/layer.json</mc:links>\n            <mc:producerName>MIKI</mc:producerName>\n            <mc:productBBox>35.2670012825,32.5856881598,35.3105702702,32.6300363309</mc:productBBox>\n            <mc:productId>11111111-1111-1111-1111-111111111111</mc:productId>\n            <mc:productName>srtm100</mc:productName>\n            <mc:productType>QuantizedMeshDTMBest</mc:productType>\n            <mc:productVersion>1</mc:productVersion>\n            <mc:productionMethod></mc:productionMethod>\n            <mc:productionSystem></mc:productionSystem>\n            <mc:productionSystemVersion>1</mc:productionSystemVersion>\n            <mc:region>Israel</mc:region>\n            <mc:sensors>UNDEFINED</mc:sensors>\n            <mc:imagingTimeEndUTC>2022-06-15</mc:imagingTimeEndUTC>\n            <mc:imagingTimeBeginUTC>2022-06-15</mc:imagingTimeBeginUTC>\n            <mc:SRS>4326</mc:SRS>\n            <mc:SRSName>WGS84GEO</mc:SRSName>\n            <mc:type>RECORD_3D</mc:type>\n            <ows:BoundingBox crs="urn:x-ogc:def:crs:EPSG:6.11:4326" dimensions="2">\n                <ows:LowerCorner>32.5856881598 35.2670012825</ows:LowerCorner>\n                <ows:UpperCorner>32.6300363309 35.3105702702</ows:UpperCorner>\n            </ows:BoundingBox>\n        </mc:MC3DRecord>\n    </csw:SearchResults>\n    </csw:GetRecordsResponse>\n'))),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Authentication must be integrated in order to communicate with 3D Tile and Catalog services."),(0,o.kt)("br",null),"\n",(0,o.kt)("strong",{parentName:"p"},"See the principles ",(0,o.kt)("a",{parentName:"strong",href:"/docs/MapColonies/authentication"},"here")))),(0,o.kt)("h2",{id:"get-layer-uri-step-2"},"Get layer URI (Step 2)"),(0,o.kt)("p",null,"In the Response, look for"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="Extract link for desired 3D model"',title:'"Extract',link:!0,for:!0,desired:!0,"3D":!0,'model"':!0},'<mc:links scheme="**3D_LAYER" name="">\n  http://3d-model-server.com/path-to-tileset.json\n</mc:links>\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"You need to save ",(0,o.kt)("inlineCode",{parentName:"strong"},"<mc:links>")," ",(0,o.kt)("u",null,"element")," value as MODEL_URL, which is a layer consumption URL."))),(0,o.kt)("h2",{id:"get-terrain-provider-uri-step-21-optional"},"Get terrain provider URI (Step 2.1, optional)"),(0,o.kt)("p",null,"In the Response, look for"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="Extract link for terrain provider"',title:'"Extract',link:!0,for:!0,terrain:!0,'provider"':!0},'<mc:links scheme="TERRAIN_QMESH" name="srtm100">\n  http://tiles.com/terrains/srtm100/layer.json\n</mc:links>\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"You need to save ",(0,o.kt)("inlineCode",{parentName:"strong"},"<mc:links>")," ",(0,o.kt)("u",null,"element")," value as TERRAIN_URL, which is a terrain provider consumption URL."))),(0,o.kt)("h2",{id:"step-3"},"Step 3"),(0,o.kt)("h3",{id:"construct-client-side-layer"},"Construct Client side Layer"),(0,o.kt)("p",null,"Now, after you got all product metadata that you need by querying our Catalog and MapProxy capabilities, lets actually use it in order to display it in real map viewer / application (clients)."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Below examples are based on ",(0,o.kt)("inlineCode",{parentName:"strong"},"Pseudo code"),", you will have to adapt it in your own application to make it work."))),(0,o.kt)("h3",{id:"cesium"},"Cesium"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"The minimum required version for cesium is v84."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// **Optional** add to Cesium terrain provider in order to clamp 3d models to the ground\nviewer.terrainProvider = new Cesium.TerrainProvider({\n  url: new Cesium.Resource({\n    url: "<TERRAIN_URL>",\n    queryParameters: {\n      "token": "<token>",\n    },\n  }),\n});\n...\n...\n// Add 3d model to the scene\nconst tileset = viewer.scene.primitives.add(\n  new Cesium.Cesium3DTileset({\n    url: new Cesium.Resource({\n      url: "<MODEL_URL>",\n      queryParameters: {\n        "token": "<token>",\n      },\n    }),\n  })\n);\n...\n')),(0,o.kt)("p",null,"Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<MODEL_URL>")," with the URL link that you got from ",(0,o.kt)("strong",{parentName:"p"},"Step 2"),"."),(0,o.kt)("p",null,"Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<TERRAIN_URL>")," with the URL link that you got from ",(0,o.kt)("strong",{parentName:"p"},"Step 2.1 (optional)"),"."),(0,o.kt)("p",null,"Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<token>")," with the token you have."))}d.isMDXComponent=!0}}]);