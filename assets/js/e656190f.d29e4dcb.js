"use strict";(self.webpackChunk_map_colonies_developer_portal=self.webpackChunk_map_colonies_developer_portal||[]).push([[1623],{9580:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>m,frontMatter:()=>c,metadata:()=>l,toc:()=>u});var r=t(74848),s=t(28453),o=t(11470),a=t(19365);t(70845);const c={id:"raster-export-guide",slug:"raster-export-guide",title:"Export Guide",tags:["guide","export","raster"]},i=void 0,l={id:"MapColonies/Raster/Guides/raster-export-guide",title:"Export Guide",description:"Export Guide step-by-step",source:"@site/docs/MapColonies/Raster/Guides/raster-export.mdx",sourceDirName:"MapColonies/Raster/Guides",slug:"/MapColonies/Raster/Guides/raster-export-guide",permalink:"/developer-portal/docs/MapColonies/Raster/Guides/raster-export-guide",draft:!1,unlisted:!1,editUrl:"https://github.com/MapColonies/developer-portal/tree/main/packages/create-docusaurus/templates/shared/docs/MapColonies/Raster/Guides/raster-export.mdx",tags:[{inline:!0,label:"guide",permalink:"/developer-portal/docs/tags/guide"},{inline:!0,label:"export",permalink:"/developer-portal/docs/tags/export"},{inline:!0,label:"raster",permalink:"/developer-portal/docs/tags/raster"}],version:"current",frontMatter:{id:"raster-export-guide",slug:"raster-export-guide",title:"Export Guide",tags:["guide","export","raster"]},sidebar:"gettingStartedSidebar",previous:{title:"Raster",permalink:"/developer-portal/docs/MapColonies/Raster/Guides/raster-getting-started"},next:{title:"Getting Started",permalink:"/developer-portal/docs/MapColonies/3D/Guides/3d-getting-started"}},d={},u=[{value:"Export Guide step-by-step",id:"export-guide-step-by-step",level:2},{value:"Flow diagram",id:"flow-diagram",level:2},{value:"Query Catalog Service (Step 1)",id:"query-catalog-service-step-1",level:2},{value:"Use Export Service (Step 2)",id:"use-export-service-step-2",level:2},{value:"Wait for callback (Step 3)",id:"wait-for-callback-step-3",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:c}=n;return c||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"export-guide-step-by-step",children:"Export Guide step-by-step"}),"\n",(0,r.jsxs)(n.p,{children:["The following guide will help you understand, ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"Step-by-step"})})," the best practices of how to work with the Map Colonies Export Sevice and how to export Mapping data to offline consumers in ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"GPKG"})})," format"]}),"\n",(0,r.jsxs)(n.p,{children:["Export service Reference is ",(0,r.jsx)(n.a,{href:"/docs/MapColonies/Raster/services/raster-export",children:"here"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," In order to get the layer id (mc",":id",") you have the following options:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Open map-colonies catalog application and locate the required layer"}),"\n"]}),"\n",(0,r.jsx)("figure",{children:(0,r.jsx)("img",{src:t(12691).A,style:{display:"block",marginLeft:"auto",marginRight:"auto"}})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Query all records via CSW GetRecords operation and search it in the result response"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/ogc/protocols/ogc-csw/ogc-csw-examples",children:"Query Examples"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"flow-diagram",children:"Flow diagram"}),"\n",(0,r.jsx)(n.p,{children:"The following flow will show you one of our main use-case's"}),"\n",(0,r.jsx)(n.mermaid,{value:"flowchart LR\n    subgraph CSW\n      direction LR\n      b1[STEP 1 <br/> Query CSW catalog]\n      b1 --\x3e b3[STEP 3<br/>Get layer id - mc:id]\n    end\n\n    subgraph  Prerequisite\n      direction LR\n      a1[Get Product_ID]\n      a2[Get Auth Token]\n    end\n\n    a1 -- product_id --\x3e b1\n    a2 -- token --\x3e b1"}),"\n",(0,r.jsx)(n.h2,{id:"query-catalog-service-step-1",children:"Query Catalog Service (Step 1)"}),"\n",(0,r.jsxs)(n.p,{children:["Query ",(0,r.jsx)(n.strong,{children:"RASTER CSW catalog"})," service to find item(s) according to desired filter ",(0,r.jsx)(n.a,{href:"/docs/ogc/protocols/ogc-csw/ogc-csw-examples",children:"example are here"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Pay attention to set the following parameter 'outputSchema=\"",(0,r.jsx)(n.a,{href:"http://schema.mapcolonies.com/raster",children:"http://schema.mapcolonies.com/raster"}),"\"' in order to get full catalog data"]})}),"\n",(0,r.jsx)(n.p,{children:"There are a few ways to acquire the productId, for example:"}),"\n",(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(a.A,{value:"SpecificLayer",label:"Specific Layer",children:[(0,r.jsx)(n.p,{children:"To fetch a specific layer you need to aquire 2 properties values:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"productType"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"productId"}),"\nTo get unique product when you already have the ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"productType"})})," and ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"productId"})})," you can use the following query (both can be coppied from our catalog app, for example for ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"Best Orthophoto"})})," use the following)"]}),"\n"]}),(0,r.jsx)(n.p,{children:"POST Request"}),(0,r.jsxs)(n.p,{children:["url:\n",(0,r.jsx)(n.code,{children:"'<RASTER-CATALOG-SERVICE_URL>/csw'"})]}),(0,r.jsx)(n.p,{children:"body (XML):"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<csw:GetRecords xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" service="CSW" maxRecords="1"  startPosition="1" outputSchema="http://schema.mapcolonies.com/raster" version="2.0.2" xmlns:mc="http://schema.mapcolonies.com/raster" >\n  <csw:Query typeNames="mc:MCRasterRecord">\n   <csw:ElementSetName>full</csw:ElementSetName>\n    <csw:Constraint version="1.1.0">\n      <Filter xmlns="http://www.opengis.net/ogc">\n        <And>\n          <PropertyIsEqualTo>\n            <PropertyName>mc:productType</PropertyName>\n            <Literal>OrthophotoBest</Literal>\n          </PropertyIsEqualTo>\n          <PropertyIsEqualTo>\n            <PropertyName>mc:productId</PropertyName>\n            <Literal>ORTHOPHOTO_MOSAIC_BASE</Literal>\n          </PropertyIsEqualTo>\n        </And>\n      </Filter>\n    </csw:Constraint>\n  </csw:Query>\n</csw:GetRecords>\n'})})]}),(0,r.jsxs)(a.A,{value:"fetchAll",label:"Fetch All Layers (Pagination)",children:[(0,r.jsx)(n.p,{children:"You can enquire all raster products, use maxRecords and startPosition for pagination:"}),(0,r.jsx)(n.p,{children:"POST Request"}),(0,r.jsxs)(n.p,{children:["url:\n",(0,r.jsx)(n.code,{children:"'<RASTER-CATALOG-SERVICE_URL>/csw'"})]}),(0,r.jsx)(n.p,{children:"body (XML):"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<csw:GetRecords xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" service="CSW" maxRecords="1"  startPosition="1"  outputSchema="http://schema.mapcolonies.com/raster" version="2.0.2" xmlns:mc="http://schema.mapcolonies.com/raster" >\n  <csw:Query typeNames="mc:MCRasterRecord">\n   <csw:ElementSetName>full</csw:ElementSetName>\n    <csw:Constraint version="1.1.0">\n      <Filter xmlns="http://www.opengis.net/ogc">\n        <PropertyIsEqualTo>\n          <PropertyName>mc:type</PropertyName>\n          <Literal>RECORD_RASTER</Literal>\n        </PropertyIsEqualTo>\n      </Filter>\n    </csw:Constraint>\n  </csw:Query>\n</csw:GetRecords>\n'})})]})]}),"\n",(0,r.jsxs)(n.p,{children:["You will get GetRecords XML Response with product ",(0,r.jsx)(n.strong,{children:"metadata"}),"."]}),"\n",(0,r.jsxs)(c,{children:[(0,r.jsx)("summary",{children:"Response example"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",metastring:'title="GetRecords Response"',children:'  <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n  \x3c!-- pycsw 2.7.dev0 --\x3e\n  <csw:GetRecordsResponse xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dct="http://purl.org/dc/terms/" xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:gml="http://www.opengis.net/gml" xmlns:ows="http://www.opengis.net/ows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mc="http://schema.mapcolonies.com/raster" version="2.0.2" xsi:schemaLocation="http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd">\n      <csw:SearchStatus timestamp="2022-02-15T15:08:58Z"/>\n      <csw:SearchResults numberOfRecordsMatched="2" numberOfRecordsReturned="1" nextRecord="2" recordSchema="http://schema.mapcolonies.com/raster" elementSet="full">\n          <mc:MCRasterRecord>\n              <mc:classification>4</mc:classification>\n              <mc:creationDateUTC>2022-02-13T13:04:23Z</mc:creationDateUTC>\n              <mc:description>World Wide 2020</mc:description>\n              <mc:footprint>{"type":"Polygon","coordinates":[[[-180,-90],[-180,90],[180,90],[180,-90],[-180,-90]]]}</mc:footprint>\n              <mc:minHorizontalAccuracyCE90>3</mc:minHorizontalAccuracyCE90>\n              <mc:id>3b3164a7-280d-4392-a82f-d60a76e69092</mc:id>\n              <mc:ingestionDate>2022-02-13T13:04:23Z</mc:ingestionDate>\n              <mc:insertDate>2022-02-13T13:04:41Z</mc:insertDate>\n              <mc:mimeType>image/jpeg</mc:mimeType>\n              <mc:links scheme="WMS" name="ORTHOPHOTO_MOSAIC_BASE" description="">\'<YOUR_MAPPROXY_URL>/service?REQUEST=GetCapabilities\'</mc:links>\n              <mc:links scheme="WMS_BASE" name="ORTHOPHOTO_MOSAIC_BASE" description="">\'<YOUR_MAPPROXY_URL>/wms\'</mc:links>\n              <mc:links scheme="WMTS" name="ORTHOPHOTO_MOSAIC_BASE" description="">\'<YOUR_MAPPROXY_URL>/wmts/1.0.0/WMTSCapabilities.xml\'</mc:links>\n              <mc:links scheme="WMTS_KVP" name="ORTHOPHOTO_MOSAIC_BASE" description="">\'<YOUR_MAPPROXY_URL>/service?REQUEST=GetCapabilities&SERVICE=WMTS\'</mc:links>\n              <mc:links scheme="WMTS_BASE" name="ORTHOPHOTO_MOSAIC_BASE" description="">\'<YOUR_MAPPROXY_URL>/wmts\'</mc:links>\n              <mc:maxResolutionMeter>0.1</mc:maxResolutionMeter>\n              <mc:producerName>IDFMU</mc:producerName>\n              <mc:productBBox>-180,-90,180,90</mc:productBBox>\n              <mc:productId>ORTHOPHOTO_MOSAIC_BASE</mc:productId>\n              <mc:productName>\u05d0\u05d5\u05e8\u05ea\u05d5\u05e4\u05d5\u05d8\u05d5 \u05de\u05ea\u05e2\u05d3\u05db\u05df</mc:productName>\n              <mc:productType>OrthophotoBest</mc:productType>\n              <mc:productVersion>1.0</mc:productVersion>\n              <mc:region>World</mc:region>\n              <mc:maxResolutionDeg>0.000171661376953125</mc:maxResolutionDeg>\n              <mc:sensors>UNDEFINED</mc:sensors>\n              <mc:imagingTimeEndUTC>2020-05-21</mc:imagingTimeEndUTC>\n              <mc:imagingTimeBeginUTC>2020-05-21</mc:imagingTimeBeginUTC>\n              <mc:SRS>4326</mc:SRS>\n              <mc:SRSName>WGS84GEO</mc:SRSName>\n              <mc:transparency>OPAQUE</mc:transparency>\n              <mc:type>RECORD_RASTER</mc:type>\n              <mc:updateDateUTC>2022-02-13T13:03:07Z</mc:updateDateUTC>\n              <ows:BoundingBox crs="urn:x-ogc:def:crs:EPSG:6.11:4326" dimensions="2">\n                  <ows:LowerCorner>-180.0 90.0</ows:LowerCorner>\n                  <ows:UpperCorner>180.0 90.0</ows:UpperCorner>\n              </ows:BoundingBox>\n          </mc:MCRasterRecord>\n      </csw:SearchResults>\n  </csw:GetRecordsResponse>\n'})})]}),"\n",(0,r.jsx)(n.h2,{id:"use-export-service-step-2",children:"Use Export Service (Step 2)"}),"\n",(0,r.jsx)(n.p,{children:"Now you need to make an export request for the desired layer."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"/docs/MapColonies/Raster/services/raster-export",children:"Service Reference"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"/docs/MapColonies/raster/services/export/api",children:"Service API"})}),"\n",(0,r.jsx)(n.p,{children:"POST Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "catalogRecordID": "3fa85f64-5717-4562-b3fc-2c963f66afa6",\n  "domain": "RASTER",\n  "ROI": {\n    "type": "FeatureCollection",\n    "features": [\n      {\n        "type": "Feature",\n        "properties": {\n          "maxResolutionDeg": 0.0439453125,\n          "minResolutionDeg": 0.17578125\n        },\n        "geometry": {\n          "type": "Polygon",\n          "coordinates": [\n            [\n              [\n                34.82836896556114,\n                32.03918441418732\n              ],\n              [\n                34.81210152170695,\n                32.03918441418732\n              ],\n              [\n                34.81210152170695,\n                32.02539369969462\n              ],\n              [\n                34.82836896556114,\n                32.02539369969462\n              ],\n              [\n                34.82836896556114,\n                32.03918441418732\n              ]\n            ]\n          ]\n        }\n      }\n    ]\n  },\n  "artifactCRS": "4326",\n  "description": "export example",\n  "keywords": {\n    "foo": "kuku"\n  },\n  "parameters": {\n    "foo": "kuku"\n  },\n  "webhook": [\n    {\n      "events": [\n        "TASK_COMPLETED"\n      ],\n      "url": "https://webhook.com"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"wait-for-callback-step-3",children:"Wait for callback (Step 3)"}),"\n",(0,r.jsxs)(n.p,{children:['Listen on "webhook url" that you provided for the response via the artifacts download url as explained in ',(0,r.jsx)(n.a,{href:"/docs/MapColonies/Raster/services/raster-export",children:"Service Reference"}),"\n... ","\ud83d\ude04"," enjoy"]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var r=t(18215);const s={tabItem:"tabItem_Ymn6"};var o=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,a),hidden:t,children:n})}},11470:(e,n,t)=>{t.d(n,{A:()=>b});var r=t(96540),s=t(18215),o=t(23104),a=t(56347),c=t(205),i=t(57485),l=t(31682),d=t(70679);function u(e){var n;return(null==(n=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:n.filter(Boolean))??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,i.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(s.location.search);n.set(o,e),s.replace({...s.location,search:n.toString()})}),[o,s])]}function x(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=p(e),[a,i]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[l,u]=h({queryString:t,groupId:s}),[x,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,o]=(0,d.Dv)(t);return[s,(0,r.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:s}),f=(()=>{const e=l??x;return m({value:e,tabValues:o})?e:null})();(0,c.A)((()=>{f&&i(f)}),[f]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),g(e)}),[u,g,o]),tabValues:o}}var g=t(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var w=t(74848);function R(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:c}=e;const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const n=e.currentTarget,t=i.indexOf(n),s=c[t].value;s!==r&&(l(n),a(s))},u=e=>{var n;let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=i.indexOf(e.currentTarget)+1;t=i[n]??i[0];break}case"ArrowLeft":{const n=i.indexOf(e.currentTarget)-1;t=i[n]??i[i.length-1];break}}null==(n=t)||n.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:c.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,w.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>i.push(e),onKeyDown:u,onClick:d,...o,className:(0,s.A)("tabs__item",f.tabItem,null==o?void 0:o.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:o}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function y(e){const n=x(e);return(0,w.jsxs)("div",{className:(0,s.A)("tabs-container",f.tabList),children:[(0,w.jsx)(R,{...n,...e}),(0,w.jsx)(v,{...n,...e})]})}function b(e){const n=(0,g.A)();return(0,w.jsx)(y,{...e,children:u(e.children)},String(n))}},70845:(e,n,t)=>{t(96540),t(44586),t(74848)},12691:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/Id_catalog-ec6cfde509e173647f6ddc5b1f4752f6.png"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var r=t(96540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);